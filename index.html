<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>2025ë…„ ì¬ì‚°ì„¸ ê³µë™ì£¼íƒ ì„¸ì•¡ê³„ì‚°</title>

<!-- PWA additions -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2c58ff">
<link rel="icon" href="icon-192.png">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
:root{ --bg:#ffffff; --card:#f8f9fa; --text:#000000; --brand:#2c58ff; --sum-bg:#e8f1ff; --input-bg:#fffbe6; --warn:#d92d20; }
*{box-sizing:border-box}
body{margin:0;background:var(--bg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#000;font-size:18px;line-height:1.65;}
.wrap{max-width:1100px;margin:36px auto;padding:0 16px}
.title{font-size:30px;font-weight:800;margin-bottom:4px}
.subtitle{font-size:15px;color:#2c58ff;margin-bottom:14px}
.subtitle .danger{color:#d92d20;font-weight:700}
.grid{display:grid;grid-template-columns:1fr;gap:18px}
@media (min-width:960px){.grid{grid-template-columns:1.2fr 1fr}}
.card{background:var(--card);border:1px solid #ddd;border-radius:12px;padding:22px;box-shadow:0 4px 12px rgba(0,0,0,.08)}
.header-row{display:flex;align-items:center;justify-content:space-between;gap:12px}
h2{font-size:24px;margin:0}
h2 .unit{font-size:12px;font-weight:600;margin-left:6px;vertical-align:middle;color:#333}
label{display:block;font-size:17px;color:#333;margin-bottom:6px}
.label-center{text-align:center}
.nowrap{white-space:nowrap;display:inline-block}
input[type="text"],input.num{width:100%;background:#fff;border:1px solid #ccc;color:#000;padding:12px 14px;border-radius:10px;outline:none;font-size:17px;text-align:right}
input.num{background:var(--input-bg)}
input:focus{border-color:#9db4ff;box-shadow:0 0 0 3px rgba(44,88,255,.15)}
.center-input{text-align:center !important}
.block-center{display:block;margin:0 auto}
.w-105{width:105px !important}
input::placeholder{color:#9aa0a6}
.row{display:grid;grid-template-columns:1fr;gap:12px}
.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.row3.align-end{align-items:end}
.row3>div{display:flex;flex-direction:column}
.row2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:640px){.row3{grid-template-columns:1fr 1fr}}
.switch{display:flex;align-items:center;gap:10px;margin:8px 0}
.switch input{accent-color:var(--brand);width:20px;height:20px}

/* ë²„íŠ¼ ê³µí†µ */
.btn{display:inline-flex;gap:6px;align-items:center;padding:14px 20px;background:#2c58ff;border:1px solid #2c58ff;color:#fff;border-radius:12px;cursor:pointer;font-weight:700;font-size:19px;text-decoration:none}
.btn:hover{filter:brightness(1.05)}
.btn .ico{font-size:18px}
.btn-secondary{background:#fff;color:#2c58ff}

/* â–¼ ì£¼íƒê³µì‹œê°€ê²© ë²„íŠ¼ ì „ìš©(2ë‹¨ê³„ ì¶•ì†Œ) */
.btn-lookup{font-size:15px;padding:10px 12px;border-radius:10px}
.btn-lookup .ico{font-size:14px}

/* ì•„ì´ì½˜í˜• ë²„íŠ¼ */
.btn-law-pill{display:inline-flex;align-items:center;gap:6px;justify-content:center;padding:8px 12px;background:#ffdede;border:1px solid #f1a9a9;color:#9a1e1e;border-radius:9999px;cursor:pointer;font-size:14px;font-weight:normal;text-align:center;white-space:nowrap;line-height:1;text-decoration:none}
.btn-law-pill:hover{filter:brightness(1.05)}
.btn-law-pill .ico{font-size:13px}
.btn-print-pill{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:8px 12px;background:#e8f7e9;border:1px solid #bde5c2;color:#1f7a33;border-radius:9999px;cursor:pointer;font-size:14px;white-space:nowrap;line-height:1;font-weight:bold;text-decoration:none}
.btn-print-pill:hover{filter:brightness(1.05)}
.btn-print-pill .ico{display:inline-block;width:14px;height:14px;border:2px solid currentColor;border-radius:2px;position:relative}
.btn-print-pill .ico:before{content:"";position:absolute;left:2px;right:2px;bottom:-2px;height:6px;border-top:2px solid currentColor}

/* ì•¡ì…˜ í–‰ */
.actions{display:flex;align-items:center;justify-content:space-between;margin-top:14px}
.actions .left{display:flex;gap:10px}
.actions .right{display:flex;gap:10px}

/* í‘œ */
.table{width:100%;border-collapse:collapse;margin-top:8px;font-size:16px;table-layout:fixed}
.table colgroup col.c1{width:29%}.table colgroup col.c2{width:34%}.table colgroup col.c3{width:37%}
.table th,.table td{padding:12px;border-bottom:1px solid #ddd;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.table thead th:first-child{text-align:center}
.table th:first-child,.table td:first-child{text-align:left}
.table td.mono{font-weight:800;font-size:17px}
.th-center{text-align:center !important}
tfoot tr{background:var(--sum-bg);font-weight:900}
tfoot th.big{font-size:19px}
.sum-amount{font-size:18px !important;font-weight:900 !important;line-height:1.2}
.subnote{font-size:60%;font-weight:600;color:#2c58ff;display:block;margin-top:1px}
.warn{color:var(--warn);font-size:13px;margin-top:10px;line-height:1.4}
.warn b{font-weight:700}
.micro{font-size:55%}
.info-table td:first-child,.info-table th:first-child{text-align:center !important}
#ê³µì •ìœ¨{text-align:right !important}

/* ì•ˆë‚´ ì„¹ì…˜ */
.tips details{margin-top:12px}
.tips summary{cursor:pointer;display:flex;align-items:center;gap:8px;font-weight:normal}
.tips .ico-info{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:999px;background:#eef3ff;border:1px solid #cdd9ff;color:#2c58ff;font-size:16px;font-weight:800;line-height:1}
.tips .small-2{font-size:90%;font-weight:normal}
.tips .tipbox{padding:10px 12px;background:#fff;border:1px solid #ddd;border-radius:10px;margin-top:8px}
.tips ol{margin:0;padding-left:18px}
.tips li{margin:6px 0}
.tips a{color:#2c58ff;text-decoration:underline}
</style>
</head>
<body>
<div class="wrap">
  <div class="title">2025ë…„ ì¬ì‚°ì„¸ ê³µë™ì£¼íƒ ì„¸ì•¡ê³„ì‚°</div>
  <div class="subtitle">
    â€» ê³µë™ì£¼íƒ(ì•„íŒŒíŠ¸, ì—°ë¦½, ë¹Œë¼, ë‹¤ì„¸ëŒ€)ì „ìš© ì„¸ì•¡ê³„ì‚°ì…ë‹ˆë‹¤.
    <span class="danger">ë‹¨ë…ì£¼íƒ ë° ë‹¤ê°€êµ¬ ì£¼íƒì€ ì„¸ì•¡ê³„ì‚° ë¶ˆê°€</span>
  </div>

  <div class="grid">
    <!-- ì…ë ¥ -->
    <div class="card">
      <div class="header-row">
        <h2>1. ì •ë³´ì…ë ¥<span class="unit">(ë‹¨ìœ„: ì›)</span></h2>
        <!-- â–¼ ì£¼íƒê³µì‹œê°€ê²© ë²„íŠ¼ ì¶•ì†Œ ë²„ì „ -->
        <button class="btn btn-secondary btn-lookup" type="button" onclick="openLookupNew()">
          <span class="ico">ğŸ”</span> ì£¼íƒê³µì‹œê°€ê²©
        </button>
      </div>

      <div class="row3 align-end" style="margin-top:10px">
        <div><label>2025ë…„ ì£¼íƒê³µì‹œê°€ê²©</label><input id="ê³µì‹œ_í˜„" class="num" type="text" placeholder="ìˆ«ìë§Œ ì…ë ¥"></div>
        <div><label>2024ë…„ ì£¼íƒê³µì‹œê°€ê²©</label><input id="ê³µì‹œ_ì „" class="num" type="text" placeholder="ìˆ«ìë§Œ ì…ë ¥"></div>
        <div><label class="label-center">ë³´ìœ  ì£¼íƒìˆ˜</label><input id="ì£¼íƒìˆ˜" class="num center-input block-center w-105" type="text" value="" placeholder="ìˆ«ìë§Œ ì…ë ¥"></div>
      </div>

      <div class="row2" style="margin-top:4px">
        <div>
          <div class="switch">
            <input id="ë„ì‹œê³¼ì„¸" type="checkbox" checked>
            <label for="ë„ì‹œê³¼ì„¸">ë„ì‹œì§€ì—­ë¶„ ê³¼ì„¸</label>
          </div>
        </div>
      </div>

      <div class="actions">
        <div class="left"><button class="btn" onclick="calc()">ê³„ì‚°í•˜ê¸°</button></div>
        <div class="right">
          <a class="btn-print-pill" href="javascript:window.print()"><span class="ico"></span> ì¸ì‡„/ì €ì¥</a>
          <a class="btn-law-pill" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95"><span class="ico">ğŸ”</span> ì§€ë°©ì„¸ë²•</a>
        </div>
      </div>

      <!-- ì•ˆë‚´ -->
      <div class="tips">
        <details>
          <summary><span class="ico-info">i</span> <span class="small-2">(ë”ë³´ê¸°)</span></summary>
          <div class="tipbox">
            <ol>
              <li>ì¬ì‚°ì„¸ëŠ” ë§¤ë…„ 6ì›” 1ì¼ í˜„ì¬ ì¬ì‚°ì˜ ì†Œìœ ìì—ê²Œ ë¶€ê³¼</li>
              <li>
                ê³¼ì„¸ëŒ€ìƒ:<br>
                7ì›”: ì£¼íƒ 1ê¸°ë¶„, ì£¼íƒì´ ì•„ë‹Œ ê±´ì¶•ë¬¼Â·ì„ ë°•Â·í•­ê³µê¸°<br>
                9ì›”: ì£¼íƒ 2ê¸°ë¶„, í† ì§€
              </li>
              <li>ë‚©ë¶€ë°©ë²•: ì€í–‰ë°©ë¬¸, <a href="https://www.wetax.go.kr" target="_blank">ìœ„í…ìŠ¤</a>, ì‹ ìš©ì¹´ë“œÂ· ê°€ìƒê³„ì¢Œ ì´ì²´ ë“±</li>
            </ol>
          </div>
        </details>
      </div>
    </div>

    <!-- ê²°ê³¼ -->
    <div class="card">
      <h2>2. ê³„ì‚° ê²°ê³¼</h2>
      <table class="table"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup>
        <thead>
          <tr><th class="th-center">ì„¸  ëª©</th><th class="mono th-center">ì´ì„¸ì•¡</th><th class="mono">ë¶„ê¸°ë³„(7Â·9ì›”)ì„¸ì•¡</th></tr>
        </thead>
        <tbody id="tb">
          <tr><td colspan="3" style="text-align:center;color:#555">ì…ë ¥ í›„ â€˜ê³„ì‚°í•˜ê¸°â€™ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</td></tr>
        </tbody>
        <tfoot>
          <tr>
            <th class="big">í•©ê³„ ì„¸ì•¡ <span class="subnote">(ì§€ì—­ìì›ì‹œì„¤ì„¸ ì œì™¸)</span></th>
            <th class="mono sum-amount" id="sumY">-</th>
            <th class="mono sum-amount" id="sumQ">-</th>
          </tr>
        </tfoot>
      </table>

      <!-- ê²½ê³  ë¬¸êµ¬ -->
      <div class="warn" style="margin-top:8px;">
        <b>ì§€ì—­ìì›ì‹œì„¤ì„¸ì™€ ì„¸ë¶€ë‹´ìƒí•œ, ê°ë©´ ë¶€ë¶„ì€ ë¯¸ë°˜ì˜</b>í•œ ì„¸ì•¡ê³„ì‚°ì…ë‹ˆë‹¤.<br>
        ê¶ê¸ˆí•˜ì‹  ì ì€ ë¶€ë™ì‚° ì†Œì¬ì§€ ê´€í• êµ¬ì²­ ì„¸ë¬´ê³¼ë¡œ ë¬¸ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
      </div>

      <div style="margin-top:10px">
        <details open><summary>ì„¸ì•¡ì‚°ì¶œ ì •ë³´</summary>
          <table class="table info-table">
            <tbody>
              <tr><td>ê³¼í‘œìƒí•œìœ¨ ì ìš© ê³µì‹œê°€ê²©</td><td class="mono" id="ì ìš©ê³µì‹œ">-</td></tr>
              <tr><td>ì¬ì‚°ì„¸ ê³¼ì„¸í‘œì¤€</td><td class="mono" id="ê³¼í‘œ">-</td></tr>
              <tr><td>ì ìš© ì„¸ìœ¨</td><td class="mono" id="ì„¸ìœ¨êµ¬ê°„">-</td></tr>
              <tr><td>ê³µì •ì‹œì¥ê°€ì•¡ë¹„ìœ¨</td><td class="mono" id="ê³µì •ìœ¨">-</td></tr>
            </tbody>
          </table>
        </details>
      </div>
    </div>
  </div>
</div>

<script>
function openLookupNew(){window.open('https://www.realtyprice.kr/notice/town/nfSiteLink.htm','_blank');}
document.addEventListener('input', e=>{
  if(e.target.classList.contains('num')){
    let v=e.target.value.replace(/,/g,'').replace(/[^\d.]/g,'');
    if(v===''){e.target.value='';return;}
    e.target.value=v.replace(/\B(?=(\d{3})+(?!\d))/g,",");
  }
});
function getNum(id){return Number((document.getElementById(id).value||'0').replace(/,/g,''));}
const fmt=n=>isFinite(n)?Math.round(n).toLocaleString('ko-KR')+'ì›':'-';
const floor10=n=>Math.floor(n/10)*10;
const fmtPct=p=>{const v=Math.round(p*10000)/100;return(Math.abs(v-Math.round(v))<1e-9)?(Math.round(v)+'%'):(v+'%');};

const TBL_GENERAL=[
  {base:0,rate:0.0010,minus:0},
  {base:6000000,rate:0.0015,minus:30000},
  {base:150000000,rate:0.0025,minus:180000},
  {base:300000000,rate:0.0040,minus:630000}
];
const TBL_SPECIAL=[
  {base:0,rate:0.0005,minus:0},
  {base:6000000,rate:0.0010,minus:30000},
  {base:150000000,rate:0.0020,minus:180000},
  {base:300000000,rate:0.0035,minus:630000}
];
function pickBracket(base,table){let cur=table[0];for(const b of table){if(base>=b.base)cur=b;else break;}return cur;}

function calc(){
  const curP=getNum('ê³µì‹œ_í˜„'), prevP=getNum('ê³µì‹œ_ì „'),
        homes=Number((document.getElementById('ì£¼íƒìˆ˜').value||'1').replace(/,/g,''))||1,
        urban=document.getElementById('ë„ì‹œê³¼ì„¸')?.checked ?? true;

  // ê³¼í‘œìƒí•œìœ¨ ì ìš© ê³µì‹œê°€ê²©: min(ì „ë…„+í˜„ë…„*5%, í˜„ë…„)
  const capPublic=prevP+curP*0.05;
  const appliedPublic=Math.min(capPublic,curP);

  // ê³µì •ì‹œì¥ê°€ì•¡ë¹„ìœ¨
  let csmar=(homes===1)
    ? (appliedPublic<=300000000?0.43:(appliedPublic<=600000000?0.44:0.45))
    : 0.60;

  // ê³¼ì„¸í‘œì¤€
  const base=Math.floor(appliedPublic*csmar);

  // 9ì–µì› ì´ˆê³¼ë©´ ì¼ë°˜ì„¸ìœ¨, ê·¸ ì™¸ 1ì£¼íƒì´ë©´ íŠ¹ë¡€ì„¸ìœ¨, ë‹¤ì£¼íƒì´ë©´ ì¼ë°˜ì„¸ìœ¨
  let rule,using;
  if(curP>900000000){rule=pickBracket(base,TBL_GENERAL);using='ì¼ë°˜ì„¸ìœ¨';}
  else{if(homes===1){rule=pickBracket(base,TBL_SPECIAL);using='1ì£¼íƒ íŠ¹ë¡€ì„¸ìœ¨';} else {rule=pickBracket(base,TBL_GENERAL);using='ì¼ë°˜ì„¸ìœ¨';}}

  // ë³¸ì„¸/ë„ì‹œì§€ì—­ë¶„/ì§€ë°©êµìœ¡ì„¸
  let y_bon=Math.round(base*rule.rate-rule.minus),
      y_city=Math.round((urban? base*0.0014:0)),
      y_edu=Math.round(y_bon*0.20);

  // ë¶„ê¸° ë°˜ì•¡ (êµìœ¡ì„¸ëŠ” 10ì› ë¯¸ë§Œ ì ˆì‚¬)
  let q_bon=y_bon/2, q_city=y_city/2, q_edu=floor10(y_edu/2);

  const y_sum=y_bon+y_city+y_edu,
        q_sum=floor10(q_bon+q_city+q_edu);

  document.getElementById('tb').innerHTML=
    '<tr><td class="th-center">ì¬ì‚°ì„¸(ë³¸ì„¸)</td><td class="mono">'+fmt(y_bon)+'</td><td class="mono">'+fmt(q_bon)+'</td></tr>'+
    '<tr><td class="th-center">ë„ì‹œì§€ì—­ë¶„</td><td class="mono">'+fmt(y_city)+'</td><td class="mono">'+fmt(q_city)+'</td></tr>'+
    '<tr><td class="th-center">ì§€ë°©êµìœ¡ì„¸</td><td class="mono">'+fmt(y_edu)+'</td><td class="mono">'+fmt(q_edu)+'</td></tr>'+
    '<tr><td class="th-center tight-sm">ì§€ì—­ìì›ì‹œì„¤ì„¸</td><td class="mono micro">ë³„ë„ê³„ì‚° í•„ìš”</td><td class="mono micro">ë³„ë„ê³„ì‚° í•„ìš”</td></tr>';

  document.getElementById('sumY').textContent=fmt(y_sum);
  document.getElementById('sumQ').textContent=fmt(q_sum);

  document.getElementById('ì ìš©ê³µì‹œ').textContent=appliedPublic.toLocaleString('ko-KR')+'ì›';
  document.getElementById('ê³¼í‘œ').textContent=base.toLocaleString('ko-KR')+'ì›';
  document.getElementById('ì„¸ìœ¨êµ¬ê°„').textContent=using;
  document.getElementById('ê³µì •ìœ¨').textContent=fmtPct(csmar);
}
</script>

<!-- PWA: service worker registration -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log('Service Worker registered'))
      .catch(err => console.error('SW registration failed:', err));
  });
}
</script>
</body>
</html>
